const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-GqBgPf2m.js","assets/react-vendor-DtX1tuCI.js","assets/Icons-D0f640cb.js","assets/firebase-auth-Dw0YbQl0.js","assets/firebase-core-CCkbINqO.js","assets/firebase-firestore-BxfwuF_F.js","assets/ProfileSetup-CBVKIEs_.js","assets/Journal-D5AesNp2.js","assets/InstallPrompt-DF5ll25_.js"])))=>i.map(i=>d[i]);
import{r as e,a as r,R as t}from"./react-vendor-DtX1tuCI.js";import{g as s,o,s as n,a,c as i}from"./firebase-auth-Dw0YbQl0.js";import{H as c}from"./firebase-core-CCkbINqO.js";import{g as l,e as d,a as u,d as f,s as m}from"./firebase-firestore-BxfwuF_F.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)}).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var p={exports:{}},y={},g=e,h=Symbol.for("react.element"),j=Symbol.for("react.fragment"),_=Object.prototype.hasOwnProperty,v=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function b(e,r,t){var s,o={},n=null,a=null;for(s in void 0!==t&&(n=""+t),void 0!==r.key&&(n=""+r.key),void 0!==r.ref&&(a=r.ref),r)_.call(r,s)&&!x.hasOwnProperty(s)&&(o[s]=r[s]);if(e&&e.defaultProps)for(s in r=e.defaultProps)void 0===o[s]&&(o[s]=r[s]);return{$$typeof:h,type:e,key:n,ref:a,props:o,_owner:v.current}}y.Fragment=j,y.jsx=b,y.jsxs=b,p.exports=y;var E=p.exports,w={},P=r;w.createRoot=P.createRoot,w.hydrateRoot=P.hydrateRoot;const S={},k=function(e,r,t){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.allSettled(r.map(e=>{if((e=function(e){return"/daily-code-journal/"+e}(e))in S)return;S[e]=!0;const r=e.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const o=document.createElement("link");return o.rel=r?"stylesheet":"modulepreload",r||(o.as="script"),o.crossOrigin="",o.href=e,t&&o.setAttribute("nonce",t),document.head.appendChild(o),r?new Promise((r,t)=>{o.addEventListener("load",r),o.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=e,window.dispatchEvent(r),!r.defaultPrevented)throw e}return s.then(r=>{for(const e of r||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})},L=c({apiKey:"AIzaSyCzkW-duMJG0oofxiP1_RuUxeSZTFE3OPg",authDomain:"daily-code-journal.firebaseapp.com",projectId:"daily-code-journal",storageBucket:"daily-code-journal.firebasestorage.app",messagingSenderId:"120707589758",appId:"1:120707589758:web:a805f734ca9fb204d21a2f"}),O=s(L),R=l(L);d(R).catch(e=>{"failed-precondition"===e.code||e.code});const I=e.lazy(()=>k(()=>import("./Login-GqBgPf2m.js"),__vite__mapDeps([0,1,2,3,4,5]))),N=e.lazy(()=>k(()=>import("./ProfileSetup-CBVKIEs_.js"),__vite__mapDeps([6,2,1,3,4,5]))),A=e.lazy(()=>k(()=>import("./Journal-D5AesNp2.js"),__vite__mapDeps([7,1,2,5,4,3]))),T=e.lazy(()=>k(()=>import("./InstallPrompt-DF5ll25_.js"),__vite__mapDeps([8,1,3,4,5]))),D=()=>E.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex flex-col items-center justify-center animate-fade-in",children:[E.jsxs("div",{className:"relative flex items-center justify-center",children:[E.jsx("div",{className:"absolute w-24 h-24 bg-purple-500/20 rounded-full blur-2xl"}),E.jsx("div",{className:"w-16 h-16 border-4 border-purple-400 border-t-transparent rounded-full animate-spin"})]}),E.jsx("p",{className:"mt-8 text-purple-200/60 text-xs font-bold tracking-[0.4em] uppercase",children:"Loading"})]});function z(){const{user:r,loading:t,login:s,logout:c}=function(){const[r,t]=e.useState(null),[s,c]=e.useState(!0);return e.useEffect(()=>o(O,e=>{t(e),c(!1)}),[]),{user:r,loading:s,login:async(e,r)=>{try{return{success:!0,user:(await a(O,e,r)).user}}catch(t){if("auth/user-not-found"===t.code||"auth/invalid-credential"===t.code)try{return{success:!0,user:(await i(O,e,r)).user,newUser:!0}}catch(s){return{success:!1,error:s.message}}return{success:!1,error:t.message}}},logout:async()=>{try{return await n(O),{success:!0}}catch(e){return{success:!1,error:e.message}}}}}(),[l,d]=e.useState({name:"",nickname:""}),[p,y]=e.useState(!1),[g,h]=e.useState(!0);e.useEffect(()=>{r?j():h(!1)},[r]);const j=async()=>{if(r)try{const e=await u(f(R,"profiles",r.uid));e.exists()?(d(e.data()),y(!1)):y(!0)}catch(e){}finally{h(!1)}};return t||g?E.jsx(D,{}):E.jsx(e.Suspense,{fallback:E.jsx(D,{}),children:E.jsx("div",{className:"animate-fade-in",children:r?p?E.jsx(N,{profile:l,setProfile:d,onSave:async e=>{if(e.name&&e.nickname)try{await m(f(R,"profiles",r.uid),e),d(e),y(!1),alert("âœ… Profile saved!")}catch(t){alert("Failed to save profile. Please try again.")}else alert("Please fill in both name and nickname")}}):E.jsxs(E.Fragment,{children:[E.jsx(T,{}),E.jsx(A,{userId:r.uid,userProfile:l,onLogout:async()=>{(await c()).success&&(d({name:"",nickname:""}),y(!1))}})]}):E.jsx(I,{onLogin:s})})})}w.createRoot(document.getElementById("root")).render(E.jsx(t.StrictMode,{children:E.jsx(z,{})})),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{},e=>{})});export{R as d,E as j};
